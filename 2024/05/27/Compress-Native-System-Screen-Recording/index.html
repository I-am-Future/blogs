<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/time-machine.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Compress Native System Screen RecordingProblem StatementThe native screen recording in Windows&#x2F;MacOS has very high quality, so that the video are usually too large to share with others. For examp">
<meta property="og:type" content="article">
<meta property="og:title" content="Compress Native System Screen Recording">
<meta property="og:url" content="http://example.com/2024/05/27/Compress-Native-System-Screen-Recording/index.html">
<meta property="og:site_name" content="Future&#39;s blog">
<meta property="og:description" content="Compress Native System Screen RecordingProblem StatementThe native screen recording in Windows&#x2F;MacOS has very high quality, so that the video are usually too large to share with others. For examp">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-27T08:46:07.000Z">
<meta property="article:modified_time" content="2024-05-29T16:51:46.898Z">
<meta property="article:author" content="Future">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2024/05/27/Compress-Native-System-Screen-Recording/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Compress Native System Screen Recording | Future's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Future's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/05/27/Compress-Native-System-Screen-Recording/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Future">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Future's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Compress Native System Screen Recording
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-27 16:46:07" itemprop="dateCreated datePublished" datetime="2024-05-27T16:46:07+08:00">2024-05-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-30 00:51:46" itemprop="dateModified" datetime="2024-05-30T00:51:46+08:00">2024-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Techniques/" itemprop="url" rel="index"><span itemprop="name">Techniques</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Compress-Native-System-Screen-Recording"><a href="#Compress-Native-System-Screen-Recording" class="headerlink" title="Compress Native System Screen Recording"></a>Compress Native System Screen Recording</h1><h2 id="Problem-Statement"><a href="#Problem-Statement" class="headerlink" title="Problem Statement"></a>Problem Statement</h2><p>The native screen recording in Windows&#x2F;MacOS has very high quality, so that the video are usually too large to share with others. For example, a 2-hour screen recording on MacOS consumes 14 GB memory!</p>
<p>However, we noticed that the screen recording from zoom&#x2F;tencent meeting is very light-weight. A 2-hour screen recording costs only hundreds of megabytes!</p>
<p>So, if we want to share the screen recording from native system to others, can we convert it to the one like the zoom? It has smaller file size and the video is quality is enough for watching.</p>
<h2 id="Observation-Analysis"><a href="#Observation-Analysis" class="headerlink" title="Observation &amp; Analysis"></a>Observation &amp; Analysis</h2><p>We get two videos, from Tencent Meeting (<code>tencent.mp4</code>) and Windows Native recording (<code>windows.mp4</code>) respectively:</p>
<table>
<thead>
<tr>
<th></th>
<th><code>tencent.mp4</code></th>
<th><code>windows.mp4</code></th>
</tr>
</thead>
<tbody><tr>
<td>Duration</td>
<td>6.7s</td>
<td>11.6s</td>
</tr>
<tr>
<td>File Size</td>
<td>261KB</td>
<td>11675KB</td>
</tr>
</tbody></table>
<p>We found that the size of <code>tencent.mp4</code> is far smaller (~20x) than the <code>windows.mp4</code>! Let’s analysis some details by the <code>ffprobe</code> provided by <code>ffmpeg</code>:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Description: Get the information of the video file using ffprobe</span></span><br><span class="line">ffprobe -v error -show_format -show_streams tencent.mp4</span><br><span class="line"></span><br><span class="line">ffprobe -v error -show_format -show_streams windows.mp4</span><br></pre></td></tr></table></figure>

<p>And here are some key observations comparison:</p>
<ol>
<li><strong>Codec Profile</strong>:<ul>
<li><code>tencent.mp4</code> uses the <strong>H.264 High Profile, which is suitable for high resolution and high compression efficiency.</strong></li>
<li><code>windows.mp4</code> uses the H.264 Main Profile, which typically has slightly lower compression efficiency compared to the High Profile.</li>
</ul>
</li>
<li><strong>Frame Rate</strong>:<ul>
<li><code>tencent.mp4</code> has a <strong>relatively low frame rate (approximately 15 fps), which helps to reduce file size.</strong></li>
<li><code>windows.mp4</code> has a higher frame rate (60 fps), which significantly increases the file size.</li>
</ul>
</li>
<li><strong>Bit Rate</strong>:<ul>
<li><code>tencent.mp4</code> has a <strong>very low bit rate (184243 bps), which greatly reduces file size but may affect video quality.</strong></li>
<li><code>windows.mp4</code> has a very high bit rate (7457076 bps), which ensures higher video quality but also results in a much larger file size.</li>
</ul>
</li>
<li><strong>Audio Settings</strong>:<ul>
<li><code>tencent.mp4</code> has <strong>mono audio and a lower sampling rate (32000 Hz), which helps to reduce file size.</strong></li>
<li><code>windows.mp4</code> has stereo audio and a higher sampling rate (48000 Hz), which increases file size.</li>
</ul>
</li>
</ol>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>From the analysis above, we come up the plan to reduce the video file size. We use <code>ffmpeg</code> to convert the videos. The following Python script helps making the <code>ffmpeg</code> commands:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Description: This script compresses a video file using ffmpeg with some preset parameters. </span></span><br><span class="line"><span class="keyword">import</span> os, pyperclip</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&#x27;input.mp4&#x27;</span></span><br><span class="line">output_file = <span class="string">&#x27;compressed_output.mp4&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># H264 (libx264) encoder</span></span><br><span class="line">profile = <span class="string">&#x27;high&#x27;</span>  <span class="comment"># H.264 encoding profile (e.g., &#x27;high&#x27;, &#x27;main&#x27;, &#x27;baseline&#x27;)</span></span><br><span class="line">crf = <span class="number">23</span>  <span class="comment"># Constant Rate Factor, the lower the value, the higher the quality (range: 0-51)</span></span><br><span class="line">bitrate = <span class="string">&#x27;184k&#x27;</span>  <span class="comment"># Video bitrate (e.g., &#x27;500k&#x27;, &#x27;1000k&#x27;)</span></span><br><span class="line">framerate = <span class="number">15</span>  <span class="comment"># Frame rate (fps)</span></span><br><span class="line">vcodec = <span class="string">&#x27;libx264&#x27;</span>  <span class="comment"># Video codec (e.g., &#x27;libx264&#x27;, &#x27;libx265&#x27;)</span></span><br><span class="line"></span><br><span class="line">cmd = <span class="string">f&#x27;ffmpeg -i <span class="subst">&#123;input_file&#125;</span> -vcodec <span class="subst">&#123;vcodec&#125;</span> -profile:v <span class="subst">&#123;profile&#125;</span> -crf <span class="subst">&#123;crf&#125;</span> &#x27;</span> \</span><br><span class="line">      <span class="string">f&#x27;-preset fast -b:v <span class="subst">&#123;bitrate&#125;</span> -r <span class="subst">&#123;framerate&#125;</span> -pix_fmt yuv420p -acodec aac &#x27;</span> \</span><br><span class="line">      <span class="string">f&#x27;-b:a 128k -ar 32000 -ac 1 <span class="subst">&#123;output_file&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">pyperclip.copy(cmd)</span><br><span class="line"><span class="built_in">print</span>(cmd)</span><br><span class="line">os.system(cmd)</span><br></pre></td></tr></table></figure>

<p>The output command example:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -vcodec libx264 -profile:v high -crf 23 -preset fast -b:v 184k -r 15 -pix_fmt yuv420p -acodec aac -b:a 128k -ar 32000 -ac 1 compressed_output.mp4</span><br></pre></td></tr></table></figure>

<p>To convert the file, we apply the high profile, a low crf, a low bitrate and framerate. You may export the video and check whether the video is over-compressed. </p>
<p><strong>Apple Silicon Acceleration</strong></p>
<p>For Apple Silicon users, we may apply the Apple’s own H264 encoding library for acceleration. The command may look like this:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Apple&#x27;s H264 encoder</span></span><br><span class="line">framerate = <span class="number">15</span>  <span class="comment"># Frame rate (fps)</span></span><br><span class="line">quality = <span class="number">10</span>  <span class="comment"># Quality</span></span><br><span class="line">cmd = <span class="string">f&#x27;ffmpeg -i <span class="subst">&#123;input_file&#125;</span> -vf &quot;scale=1920:-2,fps=<span class="subst">&#123;framerate&#125;</span>&quot; -c:v h264_videotoolbox &#x27;</span> \</span><br><span class="line">      <span class="string">f&#x27;-q:v <span class="subst">&#123;quality&#125;</span> -acodec copy &#x27;</span> \</span><br><span class="line">      <span class="string">f&#x27;<span class="subst">&#123;output_file&#125;</span>&#x27;</span></span><br></pre></td></tr></table></figure>
<p>The output command example:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -vf <span class="string">&quot;scale=1920:-2,fps=15&quot;</span> -c:v h264_videotoolbox -q:v 10 -acodec copy compressed_output.mp4</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/02/01/Isaac-Gym-Installation-with-Troubleshooting/" rel="prev" title="Isaac Gym Installation with Troubleshooting">
      <i class="fa fa-chevron-left"></i> Isaac Gym Installation with Troubleshooting
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Compress-Native-System-Screen-Recording"><span class="nav-number">1.</span> <span class="nav-text">Compress Native System Screen Recording</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Problem-Statement"><span class="nav-number">1.1.</span> <span class="nav-text">Problem Statement</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Observation-Analysis"><span class="nav-number">1.2.</span> <span class="nav-text">Observation &amp; Analysis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Solution"><span class="nav-number">1.3.</span> <span class="nav-text">Solution</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Future</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Future</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
